"use strict";angular.module("sbAdminApp").directive("stats",["onlineData","dynamic","CONFIG",function(onlineData,dynamic,CONFIG){return{templateUrl:"scripts/directives/dashboard/stats/stats.html?v="+CONFIG.version,restrict:"E",replace:!0,scope:{comments:"@",name:"@",colour:"@",details:"@",type:"@","goto":"@",large:"=",units:"@",mid:"@",task:"@",startdate:"=",enddate:"="},link:function($scope){$scope.$watch("startdate",function(newValue,oldValue){newValue!==oldValue&&onlineData.update($scope.startdate,$scope.enddate,$scope.mid,$scope.task,function(response){$scope.number=response.data.data.result,$scope.comment2=dynamic($scope.comments,response.data.data.dynamic)},function(response){$scope.number="??",angular.isObject(response.data)&&response.data.text?console.warn(response.data.text):console.warn("An unknown error occurred.")})},!0),$scope.$watch("enddate",function(newValue,oldValue){newValue!==oldValue&&onlineData.update($scope.startdate,$scope.enddate,$scope.mid,$scope.task,function(response){$scope.number=response.data.data.result,$scope.comment2=dynamic($scope.comments,response.data.data.dynamic)},function(response){$scope.number="??",angular.isObject(response.data)&&response.data.text?console.warn(response.data.text):console.warn("An unknown error occurred.")})},!0)},controller:function($scope,$window){}}}]).factory("onlineData",["$http","CONFIG",function($http,CONFIG){function update(startdate,enddate,mid,task,callback,errorCallback){$http({url:CONFIG.baseUrl+"/api/dashboard/getdata",method:"GET",cache:!1,params:{module_id:mid,task:task,startDate:startdate.getFullYear()+"-"+(startdate.getMonth()+1)+"-"+startdate.getDate(),endDate:enddate.getFullYear()+"-"+(enddate.getMonth()+1)+"-"+enddate.getDate()}}).then(function(response){callback(response)},function(response){errorCallback(response)})}var service={};return service.update=update,service}]).factory("dynamic",function(){return function(template,vars){for(var v in vars)template=template.replace("::"+v+"::",vars[v]);return template}}).factory("browserInfo",function(){function detectIE(){var ua=window.navigator.userAgent,msie=ua.indexOf("MSIE ");if(msie>0)return parseInt(ua.substring(msie+5,ua.indexOf(".",msie)),10);var trident=ua.indexOf("Trident/");if(trident>0){var rv=ua.indexOf("rv:");return parseInt(ua.substring(rv+3,ua.indexOf(".",rv)),10)}var edge=ua.indexOf("Edge/");return edge>0?parseInt(ua.substring(edge+5,ua.indexOf(".",edge)),10):!1}var version=detectIE();return version});